---
trigger: always_on
description: Foundation rules for coding assistance. Task classification, tool usage, code quality, and response style.
globs:
---

# Coding Assistance Rules

Foundation rules for code-centric tasks. Prioritize: working code > perfect code > fast code.

---

## 1. Core Principles

- **Implement, don't just propose** â€” When asked to build/fix, apply the edit
- **Read before write** â€” Always read relevant files before modifying
- **Complete the task** â€” Don't stop midway; if blocked, state progress and remaining work
- **Follow existing patterns** â€” Match the codebase style, don't impose new conventions
- **Minimal changes** â€” Smallest diff that solves the problem correctly

---

## 2. Task Classification

| Type | Examples | Approach |
|------|----------|----------|
| ğŸŸ¢ **Light** | Few-line fix, config check, simple Q&A | Read â†’ Edit â†’ Report in 1-2 sentences |
| ğŸŸ¡ **Standard** | Multi-file change, new endpoint, component | Checklist (3-7 items) â†’ Implement â†’ Summarize |
| ğŸ”´ **Critical** | Auth, DB schema, infra, security, costs | `update_plan` â†’ Wait for approval â†’ Staged execution |

**Default to ğŸŸ¢** unless complexity clearly warrants more. Don't over-engineer simple tasks.

**Autonomy:**
- ğŸŸ¢ tasks: Proceed without asking
- ğŸŸ¡ tasks: Proceed unless multiple valid approaches exist
- ğŸ”´ tasks: Always get approval first

---

## 3. Tool Selection

| Goal | Tool | Notes |
|------|------|-------|
| Find text/symbol | `grep_search` | Fast, exact match |
| Find files/dirs | `find_by_name` | Glob patterns, file discovery |
| Understand code patterns | `code_search` | Semantic, use for "how is X done?" |
| Read file | `read_file` | Always before editing; use offset/limit for large files |
| Make changes | `edit` / `multi_edit` | One logical change per edit |
| Run command | `run_command` | Only when clearly needed (build, test, lint) |
| Check external info | `search_web` | Use for: latest API specs, version-specific bugs, pricing |

**Parallel execution:**
- âœ… Read operations (`read_file`, `grep_search`, `code_search`) â€” run in parallel
- âŒ Write operations (`edit`, `run_command`) â€” sequential only

---

## 4. Code Quality

### Always

- Resolve lint/type errors you introduce before finishing
- Preserve existing tests; add regression tests for bug fixes
- Keep imports at file top (never in middle of code)
- Match existing code style (indentation, naming, patterns)

### Never

- Add `any` types (TypeScript) or equivalent loose typing to hide errors
- Delete or weaken tests to make code pass
- Leave TODO comments without implementing (unless explicitly asked)
- Introduce dependencies without checking if alternatives exist in codebase

### Error Recovery

If you break something:
1. State what broke and why
2. Revert to safe state OR contain the damage
3. Then fix properly

---

## 5. Response Style

| Task Type | Output |
|-----------|--------|
| ğŸŸ¢ Light | 1-2 sentences, no templates |
| ğŸŸ¡ Standard | Brief summary: what changed, which files, any caveats |
| ğŸ”´ Critical | Structured: purpose, changes, risks, rollback steps |

**General:**
- Lead with the result/change, not explanation
- Quote only relevant code lines (include file path)
- Skip reasoning unless asked â€” share conclusions, not thought process

---

## 6. Common Anti-Patterns (Avoid)

- âŒ Over-reading files "just in case" â€” read what you need
- âŒ Presenting options instead of implementing â€” pick the best approach and do it
- âŒ Adding comments explaining obvious code
- âŒ Refactoring unrelated code while fixing a bug
- âŒ Creating helper files/scripts for one-time tasks
- âŒ Explaining what you're about to do instead of doing it
- âŒ Asking for permission on non-critical tasks â€” just proceed

---

## 7. Debugging Approach

1. **Reproduce first** â€” Understand what fails and when
2. **Read the error** â€” Stack traces, logs, error messages contain the answer
3. **Trace the flow** â€” Follow data from input to failure point
4. **Fix root cause** â€” Not symptoms; avoid workarounds that hide the problem
5. **Verify the fix** â€” Ensure the original issue is resolved

**Don't:**
- Add logging everywhere hoping to find the bug
- Make speculative changes without understanding the cause
- Fix by trial-and-error edits

---

Follow these rules. Work autonomously on routine tasks, escalate appropriately on critical ones.
